{
  "family": "survey",
  "networkMode": "awsvpc",
  "containerDefinitions": [
    {
      "name": "survey_backend",
      "image": "913524926070.dkr.ecr.us-west-2.amazonaws.com/survey_backend:latest",
      "essential": true,
      "portMappings": [
        {
          "containerPort": 8888,
          "hostPort": 8888
        }
      ],
      "environment": [
        {
          "name": "DATABASE_URL",
          "value": "postgresql://postgres:password@db:5432/app"
        }
      ]
    },
    {
      "name": "survey_frontend",
      "image": "913524926070.dkr.ecr.us-west-2.amazonaws.com/survey_frontend:latest",
      "essential": true,
      "portMappings": [
        {
          "containerPort": 3000,
          "hostPort": 3000
        }
      ]
    },
    {
      "name": "adminer",
      "image": "survey/adminer:latest",
      "essential": true,
      "portMappings": [
        {
          "containerPort": 8080,
          "hostPort": 8080
        }
      ]
    },
    {
      "name": "mailcatcher",
      "image": "survey/mailcatcher:latest",
      "essential": true,
      "portMappings": [
        {
          "containerPort": 1025,
          "hostPort": 1025
        },
        {
          "containerPort": 1080,
          "hostPort": 1080
        }
      ]
    },
    {
      "name": "postgres",
      "image": "survey/postgres:12",
      "essential": true,
      "environment": [
        {
          "name": "POSTGRES_USER",
          "value": "postgres"
        },
        {
          "name": "POSTGRES_PASSWORD",
          "value": "password"
        },
        {
          "name": "POSTGRES_DB",
          "value": "app"
        }
      ],
      "mountPoints": [
        {
          "sourceVolume": "postgres_data",
          "containerPath": "/var/lib/postgresql/data"
        }
      ]
    },
    {
      "name": "traefik",
      "image": "survey/traefik:3.0",
      "essential": true,
      "portMappings": [
        {
          "containerPort": 80,
          "hostPort": 80
        },
        {
          "containerPort": 8080,
          "hostPort": 8080
        }
      ],
      "command": [
        "--api.insecure=true",
        "--providers.docker=true",
        "--entrypoints.web.address=:80"
      ],
      "volumes": [
        {
          "name": "docker_sock",
          "host": {
            "sourcePath": "/var/run/docker.sock"
          }
        }
      ]
    }
  ],
  "requiresCompatibilities": [
    "FARGATE"
  ],
  "cpu": "512",
  "memory": "1024",
  "volumes": [
    {
      "name": "postgres_data",
      "host": {}
    },
    {
      "name": "docker_sock",
      "host": {
        "sourcePath": "/var/run/docker.sock"
      }
    }
  ]
}
